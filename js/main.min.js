document.querySelector(".burger-trigger").addEventListener("click",function(e){document.querySelector(".burger").classList.toggle("active"),e.currentTarget.classList.toggle("active"),searchQuery="";e=document.getElementById("search-input-mobile"),e&&(e.value=""),e=document.getElementById("search-input-desktop");e&&(e.value=""),renderProfiles()}),document.addEventListener("click",function(e){var t;e.target.closest(".burger-nav a")&&(e=document.querySelector(".burger"),t=document.querySelector(".burger-trigger"),e.classList.remove("active"),t.classList.remove("active"),searchQuery="",(e=document.getElementById("search-input-mobile"))&&(e.value=""),(t=document.getElementById("search-input-desktop"))&&(t.value=""),renderProfiles())});var searchQuery="";function renderProfiles(){var s,n=document.getElementById("profiles-list");n&&(document.getElementById("feedbackModal")||document.body.insertAdjacentHTML("beforeend",'\n      <div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title" id="feedbackModalLabel">學員回饋</h5>\n              <button type="button" class="btn-close-custom text-primary" data-bs-dismiss="modal" aria-label="Close">\n                <i class="fas fa-window-close"></i>\n              </button>\n            </div>\n            <div class="modal-body">\n              <div id="feedbackContent"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-outline-secondary modal-close-btn btn-close" data-bs-dismiss="modal">關閉</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    '),document.getElementById("courseModal")||document.body.insertAdjacentHTML("beforeend",'\n      <div class="modal fade" id="courseModal" tabindex="-1" aria-labelledby="courseModalLabel" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title" id="courseModalLabel">課程資訊</h5>\n              <button type="button" class="btn-close-custom text-primary" data-bs-dismiss="modal" aria-label="Close">\n                <i class="fas fa-window-close"></i>\n              </button>\n            </div>\n            <div class="modal-body">\n              <div id="courseContent"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-outline-secondary modal-close-btn btn-close" data-bs-dismiss="modal">關閉</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    '),s=function(e,t){if(!t)return null;if("string"==typeof(a=t)&&/^https?:\/\//.test(a))return t;var a;switch(e){case"ig":return"https://www.instagram.com/".concat(t);case"fb":return"https://www.facebook.com/".concat(t);case"threads":return"https://www.threads.net/@".concat(t);case"yt":return"https://www.youtube.com/".concat(t);default:return t}},fetch("responses.json",{cache:"no-cache"}).then(function(e){return e.json()}).then(function(e){var t,a,o;Array.isArray(e)&&(a=e,"#Coach"===(t=window.location.hash)?a=e.filter(function(e){return e.type&&e.type.includes("全真教練")}):"#Aerobic"===t?a=e.filter(function(e){return e.fields&&e.fields.includes("有氧")}):"#Yoga"===t&&(a=e.filter(function(e){return e.fields&&(e.fields.includes("瑜珈")||e.fields.includes("瑜伽"))})),(a=searchQuery?a.filter(function(e){var t=(e.name||"").toLowerCase(),a=(e.type||"").toLowerCase(),o=(e.fields||"").toLowerCase(),e=(e.location||"").toLowerCase(),n=searchQuery.toLowerCase();return t.includes(n)||a.includes(n)||o.includes(n)||e.includes(n)}):a).sort(function(e,t){e=(e.name||"").toLowerCase(),t=(t.name||"").toLowerCase();return e.localeCompare(t)}),e=a.map(function(e,t){var t=String(e.fields||"").includes("瑜珈")||String(e.fields||"").includes("瑜伽")?"images/yoga".concat(t%7+1,".png"):"images/fitness".concat(t%6+1,".png"),a=s("line",e.Line),o=s("fb",e.FB),n=s("ig",e.IG),d=s("threads",e.Threads),r=s("yt",e["YT "]);return'<div class="d-flex"><div class="card bg-white rounded-2 p-2 mt-6 mb-3 w-100 d-flex flex-column"><div class="text-center" style="margin-top:-66px;">'+'<img class="card-img-top rounded-circle" src="'.concat(t,'" loading="lazy" alt="').concat(e.name||"",'" style="width: 120px; height: 120px; object-fit: cover;">')+'</div><div class="card-body d-flex flex-column flex-grow-1"><div class="text-center">'+'<h4 id="name" class="card-title py-2">'.concat(e.name||"未命名","</h4>")+'<div class="d-flex flex-wrap justify-content-center gap-1">'+(e.fields?e.fields.split(",").map(function(e){return e.trim()}).filter(function(e){return e}).map(function(e){return'<span class="small badge badge-pill badge-light text-gray bg-white rounded-pill px-3 py-2 border">'.concat(e,"</span>")}).join(""):"")+(e.type?e.type.split(",").map(function(e){return e.trim()}).filter(function(e){return e}).map(function(e){return'<span class="small badge badge-pill badge-light text-gray bg-white rounded-pill px-3 py-2 border">'.concat(e,"</span>")}).join(""):"")+'</div></div><div class="text-center mt-4"><i class="fas fa-map-marker-alt text-primary me-2"></i>'+'<span id="location" class="small">'.concat(e.location||"","</span>")+'</div><div class="social-row d-flex justify-content-center gap-3 mt-4" aria-label="social links">'+(a?'<a class="social-btn social-line" href="'.concat(a,'" target="_blank" rel="noopener noreferrer" aria-label="Line"><i class="fab fa-line" aria-hidden="true"></i></a>'):"")+(o?'<a class="social-btn social-fb" href="'.concat(o,'" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>'):"")+(n?'<a class="social-btn social-ig" href="'.concat(n,'" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram" aria-hidden="true"></i></a>'):"")+(d?'<a class="social-btn social-threads" href="'.concat(d,'" target="_blank" rel="noopener noreferrer" aria-label="Threads"><i class="fab fa-threads" aria-hidden="true"></i></a>'):"")+(r?'<a class="social-btn social-yt" href="'.concat(r,'" target="_blank" rel="noopener noreferrer" aria-label="YouTube"><i class="fab fa-youtube" aria-hidden="true"></i></a>'):"")+'</div><div class="d-flex justify-content-center align-items-center mt-4 mb-2">'+(e.name&&e.feedback&&e.feedback.trim()?'<a href="#" class="feedback-link text-decoration-none" data-name="'.concat(encodeURIComponent(e.name),'" data-feedback="').concat(encodeURIComponent(e.feedback),'">學員回饋</a>'):"")+(e.name&&e.feedback&&e.feedback.trim()&&e.otherPlaces&&e.otherPlaces.trim()?'<span class="mx-2 text-muted">|</span>':"")+(e.name&&e.otherPlaces&&e.otherPlaces.trim()?'<a href="#" class="course-link text-decoration-none" data-name="'.concat(encodeURIComponent(e.name),'" data-fields="').concat(encodeURIComponent(e.fields||""),'" data-type="').concat(encodeURIComponent(e.type||""),'" data-location="').concat(encodeURIComponent(e.location||""),'" data-otherplaces="').concat(encodeURIComponent(e.otherPlaces),'">課程資訊</a>'):"")+"</div></div></div></div>"}).join(""),o="",o=searchQuery?'<h1 class="text-center mb-4 text-primary">搜尋結果: "'.concat(searchQuery,'" (').concat(a.length," 筆)</h1>"):"#Coach"===t?'<h1 class="text-center mb-4 text-primary">全真教練</h1>':"#Aerobic"===t?'<h1 class="text-center mb-4 text-primary">有氧老師</h1>':"#Yoga"===t?'<h1 class="text-center mb-4 text-primary">瑜珈老師</h1>':'<h1 class="text-center mb-4 text-primary">所有教練與老師</h1>',n.innerHTML='\n        <div class="container">\n          '.concat(o,'\n          <div class="profiles-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">\n            ').concat(e,'\n          </div>\n          <div class="text-center mt-5">\n            <div class="d-flex flex-column flex-md-row justify-content-center align-items-center gap-3">\n              <a href="https://docs.google.com/forms/d/e/1FAIpQLSeWayS7SnVsHH_OaCbyLY_bbq7tucrWgsfPd5xL9sxG-TG04A/viewform" class="btn btn-outline-primary">\n                <i class="fas fa-envelope me-2"></i>\n                提供教練與老師資訊\n              </a>\n              <a href="mailto:jmispace@gmail.com?subject=註明授課老師，地點，修正項目&body=老師：%0D%0A地點：%0D%0A修正項目：%0D%0A" class="btn btn-outline-primary">\n                <i class="fas fa-envelope me-2"></i>\n                修正聯絡信箱\n              </a>\n            </div>\n          </div>\n        </div>\n      '),t)&&window.scrollTo({top:0,behavior:"smooth"})}).catch(function(){}))}function closeModal(e){e.style.display="none",e.classList.remove("show"),e.setAttribute("aria-hidden","true"),document.body.classList.remove("modal-open");e=document.getElementById("modalBackdrop")||document.getElementById("courseModalBackdrop")||document.getElementById("mobileSearchModalBackdrop");e&&e.remove()}document.addEventListener("click",function(e){var t;e.target&&("mobile-search-trigger"===e.target.id||e.target.closest("#mobile-search-trigger"))&&(e.preventDefault(),e.stopPropagation(),t=document.getElementById("mobileSearchModal"))&&("undefined"!=typeof bootstrap&&bootstrap.Modal?new bootstrap.Modal(t).show():(t.style.display="block",t.classList.add("show"),t.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open"),(t=document.getElementById("mobileSearchModalBackdrop"))&&t.remove(),(t=document.createElement("div")).className="modal-backdrop fade show",t.id="mobileSearchModalBackdrop",t.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; z-index: 1040 !important; background-color: rgba(0, 0, 0, 0.5) !important;",document.body.appendChild(t))),e.target&&("search-btn-mobile"===e.target.id||e.target.closest("#search-btn-mobile"))&&(e.preventDefault(),e.stopPropagation(),t=document.getElementById("search-input-mobile"))&&(searchQuery=t.value.trim(),renderProfiles(),e=document.getElementById("mobileSearchModal"))&&("undefined"!=typeof bootstrap&&bootstrap.Modal?(t=bootstrap.Modal.getInstance(e))&&t.hide():closeModal(e))}),document.addEventListener("keypress",function(e){var t,a;e.target&&"search-input-mobile"===e.target.id&&"Enter"===e.key&&(searchQuery=e.target.value.trim(),renderProfiles(),t=document.getElementById("mobileSearchModal"))&&("undefined"!=typeof bootstrap&&bootstrap.Modal?(a=bootstrap.Modal.getInstance(t))&&a.hide():closeModal(t)),e.target&&"search-input-desktop"===e.target.id&&"Enter"===e.key&&(searchQuery=e.target.value.trim(),renderProfiles())}),document.addEventListener("input",function(e){e.target&&"search-input-mobile"===e.target.id&&(searchQuery=""===e.target.value.trim()?"":e.target.value.trim(),renderProfiles()),e.target&&"search-input-desktop"===e.target.id&&(searchQuery=""===e.target.value.trim()?"":e.target.value.trim(),renderProfiles())}),renderProfiles(),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("mobile-search-trigger"),e=(e&&e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("Mobile search trigger clicked directly");var e=document.getElementById("mobileSearchModal");e&&("undefined"!=typeof bootstrap&&bootstrap.Modal?new bootstrap.Modal(e).show():(e.style.display="block",e.classList.add("show"),e.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open"),(e=document.getElementById("mobileSearchModalBackdrop"))&&e.remove(),(e=document.createElement("div")).className="modal-backdrop fade show",e.id="mobileSearchModalBackdrop",e.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; z-index: 1040 !important; background-color: rgba(0, 0, 0, 0.5) !important;",document.body.appendChild(e)))}),document.getElementById("search-btn-mobile"));e&&e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("Mobile search button clicked directly");var t,e=document.getElementById("search-input-mobile");e&&(searchQuery=e.value.trim(),renderProfiles(),e=document.getElementById("mobileSearchModal"))&&("undefined"!=typeof bootstrap&&bootstrap.Modal?(t=bootstrap.Modal.getInstance(e))&&t.hide():closeModal(e))})}),window.addEventListener("hashchange",function(){document.getElementById("profiles-list")&&(window.scrollTo({top:0,behavior:"smooth"}),renderProfiles())}),document.addEventListener("click",function(e){var t,a;e.target.classList.contains("feedback-link")&&(e.preventDefault(),e=e.target,a=decodeURIComponent(e.dataset.name),e=decodeURIComponent(e.dataset.feedback),document.getElementById("feedbackModalLabel").textContent="".concat(a," - 學員回饋"),e&&e.trim()?document.getElementById("feedbackContent").innerHTML=e:document.getElementById("feedbackContent").innerHTML='<p class="text-muted">暫無回饋內容</p>',(t=document.getElementById("feedbackModal"))?"undefined"!=typeof bootstrap&&bootstrap.Modal?new bootstrap.Modal(t).show():(t.style.display="block",t.classList.add("show"),t.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open"),(a=document.getElementById("modalBackdrop"))&&a.remove(),(e=document.createElement("div")).className="modal-backdrop fade show",e.id="modalBackdrop",document.body.appendChild(e),e.addEventListener("click",function(){t.style.display="none",t.classList.remove("show"),t.setAttribute("aria-hidden","true"),document.body.classList.remove("modal-open");var e=document.getElementById("modalBackdrop");e&&e.remove()})):console.error("Modal element not found"))}),document.addEventListener("click",function(e){var t;(e.target.classList.contains("btn-close-custom")||e.target.closest(".btn-close-custom"))&&(e.preventDefault(),t=e.target.closest(".modal"))&&closeModal(t),e.target.classList.contains("modal-close-btn")&&(e.preventDefault(),t=e.target.closest(".modal"))&&closeModal(t),"mobileSearchModalBackdrop"===e.target.id&&(t=document.getElementById("mobileSearchModal"))&&closeModal(t)}),document.addEventListener("click",function(e){var t,a,o;e.target.classList.contains("course-link")&&(e.preventDefault(),e=e.target,a=decodeURIComponent(e.dataset.name),decodeURIComponent(e.dataset.fields),decodeURIComponent(e.dataset.type),decodeURIComponent(e.dataset.location),e=decodeURIComponent(e.dataset.otherplaces),document.getElementById("courseModalLabel").textContent="".concat(a," - 課程資訊"),a='<div class="course-info">',e&&(a+='<div class="mb-3"><span class="text-muted">'.concat(e,"</span></div>")),a+="</div>",document.getElementById("courseContent").innerHTML=a,(t=document.getElementById("courseModal"))?"undefined"!=typeof bootstrap&&bootstrap.Modal?new bootstrap.Modal(t).show():(t.style.display="block",t.classList.add("show"),t.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open"),(e=document.getElementById("courseModalBackdrop"))&&e.remove(),(a=document.createElement("div")).className="modal-backdrop fade show",a.id="courseModalBackdrop",document.body.appendChild(a),a.addEventListener("click",o=function(){t.style.display="none",t.classList.remove("show"),t.setAttribute("aria-hidden","true"),document.body.classList.remove("modal-open");var e=document.getElementById("courseModalBackdrop");e&&e.remove()}),t.querySelectorAll(".btn-close").forEach(function(e){return e.addEventListener("click",o)}),t.querySelector(".btn-secondary").addEventListener("click",o)):console.error("Course modal element not found"))});